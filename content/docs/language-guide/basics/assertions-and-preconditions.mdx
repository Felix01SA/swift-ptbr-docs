---
title: Afirmações e pré-condições
---

## Afirmações e pré-condições

Afirmações e pré-condições são verificações que acontecem em tempo de execução. Você os usa para garantir que uma condição essencial seja satisfeita antes de executar qualquer outro código. Se a condição booleana na afirmação ou pré-condição for avaliada como verdadeira, a execução do código continuará como de costume. Se a condição for avaliada como falsa, o estado atual do programa é inválido; a execução do código termina e seu aplicativo é encerrado.

Você usa afirmações e pré-condições para expressar as suposições que faz e as expectativas que tem durante a codificação, para que possa incluí-las como parte do seu código. As afirmações ajudam você a encontrar erros e suposições incorretas durante o desenvolvimento, e as pré-condições ajudam você a detectar problemas na produção.

Além de verificar suas expectativas em tempo de execução, as afirmações e pré-condições também se tornam uma forma útil de documentação dentro do código. Ao contrário das condições de erro discutidas em [Tratamento de Erros](#error-handling) acima, as afirmações e pré-condições não são usadas para erros recuperáveis ou esperados. Como uma afirmação ou pré-condição com falha indica um estado inválido do programa, não há como capturar uma afirmação com falha.

Usar asserções e pré-condições não é um substituto para projetar seu código de tal forma que seja improvável que surjam condições inválidas. No entanto, usá-los para impor dados e status válidos faz com que seu aplicativo termine de forma mais previsível se ocorrer um estado inválido e ajuda a tornar o problema mais fácil de depurar. Interromper a execução assim que um estado inválido for detectado também ajuda a limitar os danos causados por esse estado inválido.

A diferença entre asserções e pré-condições é quando elas são verificadas: As asserções são verificadas apenas em compilações de depuração, mas as pré-condições são verificadas em compilações de depuração e produção. Em compilações de produção, a condição dentro de uma afirmação não é avaliada. Isso significa que você pode usar quantas afirmações quiser durante seu processo de desenvolvimento, sem afetar o desempenho na produção

### Depuração com Afirmações

Você escreve uma afirmação chamando a função [`assert(_:_:file:line:){:swift}`](https://developer.apple.com/documentation/swift/1541112-assert) da biblioteca padrão do Swift. Você passa para esta função uma expressão que é avaliada como verdadeira ou falsa e uma mensagem para exibir se o resultado da condição for falso. Por exemplo:

```swift
let age = -3
assert(age >= 0, "A idade de uma pessoa não pode ser menor que zero.")
// Esta afirmação falha porque -3 não é >= 0.
```

Neste exemplo, a execução do código continua se `age >= 0{:swift}` for avaliada como verdadeira, ou seja, se o valor da idade não for negativo. Se o valor da idade for negativo, como no código acima, então `age >= 0{:swift}` é avaliada como falsa e a afirmação falha, encerrando o aplicativo.

Você pode omitir a mensagem de afirmação, por exemplo, quando ela apenas repetiria a condição como prosa.

```swift
assert(age >= 0)
```

Se o código já verificar a condição, use a função [`assertionFailure(_:file:line:){:swift}`](https://developer.apple.com/documentation/swift/1539616-assertionfailure) para indicar que uma afirmação falhou. Por exemplo:

```swift lineNumbers
if age > 10 {
  print("Você pode andar de montanha-russa ou de roda-gigante.")
} else if age >= 0 {
  print("Você pode andar na roda-gigante.")
} else {
  assertionFailure("A idade de uma pessoa não pode ser menor que zero.")
}
```

### Ampor as Pré-Condições

Use uma pré-condição sempre que uma condição tiver o potencial de ser falsa, mas _definitivamente_ deve ser verdadeira para que seu código continue a execução. Por exemplo, use uma pré-condição para verificar se um subscrito não está fora dos limites ou para verificar se uma função passou um valor válido.

Você escreve uma pré-condição chamando a função [`precondition(_:_:file:line:){:swift}`](https://developer.apple.com/documentation/swift/1540960-precondition). Você passa para esta função uma expressão que é avaliada como verdadeira ou falsa e uma mensagem para exibir se o resultado da condição for falso. Por exemplo:

```swift
// Na implementação de um subscript...
precondition(index > 0, "O índice deve ser maior que zero.")
```

Você também pode chamar a função [`preconditionFailure(_:file:line:){:swift}`](https://developer.apple.com/documentation/swift/1539374-preconditionfailure) para indicar que ocorreu uma falha, por exemplo, se o caso padrão de um `switch` foi tomado, mas todos os dados de entrada válidos devem ter sido tratados por um dos outros casos do `switch`.

:::info[Nota]

Se você compilar no modo desmarcado (`-Ounchecked`), as pré-condições não são marcadas. O compilador assume que as pré-condições são sempre verdadeiras e otimiza seu código de acordo. No entanto, a função `fatalError(_:file:line:){:swift}` sempre interrompe a execução, independentemente das configurações de otimização.

Você pode usar a função `fatalError(_:file:line:){:swift}` durante a prototipagem e o desenvolvimento inicial para criar stubs para funcionalidades que ainda não foram implementadas, escrevendo `fatalError("Unimplemented"){:swift}` como a implementação de stub. Como os erros fatais nunca são otimizados, ao contrário de asserções ou pré-condições, você pode ter certeza de que a execução sempre será interrompida se encontrar uma implementação de `stub`.

:::
